angular.module("md.data.table",[]).directive("mdTableBody",function(){"use strict";return{require:"^mdDataTable",link:function(a,b,c,d){a.isSelected=function(a){return-1!==d.selectedItems.indexOf(a)},a.toggleRow=function(b){a.isSelected(b)?d.selectedItems.splice(d.selectedItems.indexOf(b),1):d.selectedItems.push(b)}}}}),angular.module("md.data.table").controller("mdDataTableController",["$attrs","$parse","$scope",function(a,b,c){"use strict";this.selectedItems=[],a.mdRowSelect&&b(a.mdRowSelect).assign(c.$parent.$parent,this.selectedItems)}]),angular.module("md.data.table").directive("mdDataTable",["$mdTableRepeat","$timeout",function(a,b){"use strict";function c(a,c,d,e){function f(a,b){angular.forEach(l.rows,function(c){b(c.children[a])})}function g(a){return d.hasOwnProperty("mdRowSelect")&&0===a}function h(a,b){return g(b)||!a.attributes.numeric?m.push({isNumeric:!1}):(a.style.textAlign="right",m.push({isNumeric:!0,unit:a.attributes.unit?a.attributes.unit.value:void 0,precision:a.attributes.precision?a.attributes.precision.value:void 0}),void(m[b].unit&&(a.innerHTML+=" ("+m[b].unit+")")))}function i(){k.children().addClass("trim animate"),angular.forEach(k.children(),function(a,b){g(b)||(a.innerHTML="<div>"+a.innerHTML+"</div>")}),c.css({"min-width":100*k.children().length+"px","table-layout":"fixed"})}function j(){k=c.find("thead").find("tr"),angular.forEach(k.children(),h),d.hasOwnProperty("trimColumnNames")&&i()}var k,l,m=[];e.ready=function(){l={rows:c.find("tbody").find("tr")},k||(this.setFilter(l.rows),j()),b(function(){angular.forEach(k.children(),function(a,b){g(b)||m[b].isNumeric&&f(b,function(a){a.style.textAlign="right",a.innerHTML=parseInt(a.innerHTML).toFixed(m[b].precision),a.attributes.hasOwnProperty("show-unit")&&(a.innerHTML+=m[b].unit)})})})}}function d(b,d){var e=b.find("thead"),f=b.find("tbody");if(!e.length){if(e=b.find("tbody").eq(0),!e.children().find("th").length)throw new Error("mdDataTable","Expecting <thead></thead> element.");e.replaceWith("<thead>"+e.html()+"</thead>"),e=b.find("thead"),f=b.find("tbody")}if(e=e.attr("md-table-head","").find("tr"),f=f.attr("md-table-body","").find("tr"),f.attr("ng-repeat")){var g=a.parse(f.attr("ng-repeat"));d.hasOwnProperty("mdRowSelect")&&(e.checkbox=angular.element("<md-checkbox></md-checkbox>"),f.checkbox=angular.element("<md-checkbox></md-checkbox>"),e.checkbox.attr("aria-label","Select All"),e.checkbox.attr("ng-click","toggleAll("+g.items+")"),e.checkbox.attr("ng-class","{'md-checked': allSelected("+g.items+")}"),f.checkbox.attr("aria-label","Select Row"),f.checkbox.attr("ng-click","toggleRow("+g.item+")"),f.checkbox.attr("ng-class","{'md-checked': isSelected("+g.item+")}"),e.prepend(angular.element("<th></th>").append(e.checkbox)),f.prepend(angular.element("<td></td>").append(f.checkbox))),d.hasOwnProperty("mdColumnSort")&&(e.attr("md-filter")||g.orderBy||f.attr("ng-repeat",g.insertOrderBy("order"))),f.attr("md-table-repeat","")}else{if(d.hasOwnProperty("mdRowSelect"))return console.warn("Use ngRepeat to enable automatic row selection.");d.hasOwnProperty("mdColumnSort")&&(d.mdFilter?console.warn("Manual sorting may be difficult without ngRepeat."):console.warn("Use ngRepeat to enable automatic column sorting."))}return c}return{restrict:"A",scope:{filter:"=mdFilter",selectedItems:"=mdRowSelect"},compile:d,controller:"mdDataTableController"}}]),angular.module("md.data.table").directive("mdTableHead",["$compile","$mdTableRepeat","$parse",function(a,b,c){"use strict";return{require:"^mdDataTable",link:function(d,e,f,g){function h(b,c){if(!e.parent().attr("md-row-select")||0!==c){var f=b.attributes["order-by"]||{value:b.textContent.toLowerCase()};b.setAttribute("order-by",f.value),b.setAttribute("ng-class","{'md-active': isActive('"+f.value+"')}"),b.setAttribute("ng-click","orderBy('"+f.value+"')"),a(b)(d)}}function i(a){k=c(b.parse(a.attr("ng-repeat")).orderBy),d.isActive=function(a){return k(d)===a||k(d)==="-"+a},d.orderBy=function(a){k.assign(d,k(d)===a?"-"+a:a)}}function j(){d.isActive=function(a){return k===a||k==="-"+a},d.orderBy=function(a){g.selectedItems.splice(0),d.filter(k=k===a?"-"+a:a)}}var k;g.setFilter=function(a){void 0!==e.parent().attr("md-column-sort")&&(angular.forEach(e.find("tr").children(),h),e.parent().attr("md-filter")?j():i(a))},d.allSelected=function(a){return a?a.length===g.selectedItems.length:!1},d.toggleAll=function(a){d.allSelected(a)?g.selectedItems.splice(0):angular.forEach(a,function(a){-1===g.selectedItems.indexOf(a)&&g.selectedItems.push(a)})}}}}]),angular.module("md.data.table").directive("mdTableRepeat",function(){"use strict";return{require:"^mdDataTable",link:function(a,b,c,d){a.$last&&d.ready()}}}),angular.module("md.data.table").factory("$mdTableRepeat",function(){"use strict";function a(a){for(this._tokens=a.split(" "),this._iterator=0,this.item=this.current();this.hasNext()&&"in"!==this.getNext();)this.item+=this.current();for(this.items=this.getNext();this.hasNext()&&-1===["|","track"].indexOf(this.getNext());)this.items+=this.current();this.orderBy=void 0,this.hasNext()&&"orderBy:"===this.getNext()&&(this.orderBy=this.getNext()),this.trackBy=void 0,this.hasNext()&&(this.trackBy="by"===this.getNext()?this.getNext():this.current())}function b(b){return c.hasOwnProperty(b)?c[b]:c[b]=new a(b)}var c={};return a.prototype.current=function(){return this._tokens[this._iterator]},a.prototype.getNext=function(){return this._tokens[++this._iterator]},a.prototype.getValue=function(){return this._tokens.join(" ")},a.prototype.hasNext=function(){return this._iterator<this._tokens.length-1},a.prototype.insertOrderBy=function(a){return this.orderBy=a,this._iterator=this.trackBy?this._tokens.indexOf(this.trackBy):this._tokens.length,this._tokens.splice(this._iterator,0,"|","orderBy:",a),this._tokens.join(" ")},{parse:b}});